{"ast":null,"code":"import _slicedToArray from\"C:/Users/magma/Downloads/Lab 4/Lab-4/library-fe/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import auth from\"../data/Auth\";import{useNavigate}from\"react-router-dom\";import AppBar from\"../components/AppBar\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AccountPage=function AccountPage(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var navigate=useNavigate();useEffect(function(){if(!auth.isAuthenticated()){navigate(\"/login\");}});var handleLogout=function handleLogout(){auth.userLogout();navigate(\"/\");};var handleDeleteAccount=function handleDeleteAccount(){fetch(\"/user/delete?username=\"+auth.getUser(),{method:\"DELETE\",headers:{'Content-Type':'application/json'}}).then(function(response){if(response.ok){handleLogout();}else if(response.status==400){setError(\"Nie można usunąć konta mając pożyczone książki!\");}else{setError(\"Wystąpił nieoczekiwany błąd.\");}});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,{}),/*#__PURE__*/_jsx(\"h1\",{children:\"My Account\"}),error!=\"\"?/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-warning alert-dismissible fade show\",role:\"alert\",children:error}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"container m-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:\"Username\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:auth.getUser()}),/*#__PURE__*/_jsx(\"div\",{className:\"w-100\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:\"User type\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:auth.isLibrarian()?\"librarian\":\"user\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-grid gap-2 d-md-flex mt-2\",children:[!auth.isLibrarian()?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(\"button\",{className:\"primary\",onClick:handleDeleteAccount,children:\"Delete my account\"})})}):null,/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(\"button\",{className:\"primary\",onClick:handleLogout,children:\"Log Out\"})})]})]})]});};export default AccountPage;","map":{"version":3,"names":["React","useEffect","useState","auth","useNavigate","AppBar","AccountPage","error","setError","navigate","isAuthenticated","handleLogout","userLogout","handleDeleteAccount","fetch","getUser","method","headers","then","response","ok","status","isLibrarian"],"sources":["C:/Users/magma/Downloads/Lab 4/Lab-4/library-fe/src/pages/AccountPage.tsx"],"sourcesContent":["import React, {useEffect, useState} from 'react'\r\nimport auth from \"../data/Auth\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport AppBar from \"../components/AppBar\";\r\n\r\n\r\nconst AccountPage = () => {\r\n    const [error, setError] = useState(\"\");\r\n    const navigate = useNavigate();\r\n\r\n    useEffect( () => {\r\n        if(!auth.isAuthenticated()){\r\n            navigate(\"/login\");\r\n        }\r\n    })\r\n\r\n    const handleLogout = () => {\r\n        auth.userLogout();\r\n        navigate(\"/\");\r\n    }\r\n\r\n    const handleDeleteAccount = () => {\r\n        fetch(\"/user/delete?username=\"+auth.getUser(),\r\n            {method: \"DELETE\", headers: {'Content-Type': 'application/json'}})\r\n            .then(response => {\r\n                if(response.ok){\r\n                    handleLogout();\r\n                } else if (response.status == 400){\r\n                    setError(\"Nie można usunąć konta mając pożyczone książki!\")\r\n                } else {\r\n                    setError(\"Wystąpił nieoczekiwany błąd.\")\r\n                }\r\n            })\r\n    }\r\n\r\n    return(\r\n        <>\r\n            <AppBar />\r\n            <h1>My Account</h1>\r\n\r\n            {error != \"\" ?\r\n                <div className=\"alert alert-warning alert-dismissible fade show\" role=\"alert\">\r\n                    {error}\r\n                </div> : null\r\n            }\r\n\r\n            <div className=\"container m-2\">\r\n\r\n                <div className=\"row\">\r\n                    <div className=\"col\">Username</div>\r\n                    <div className=\"col\">{auth.getUser()}</div>\r\n                    <div className=\"w-100\"></div>\r\n                    <div className=\"col\">User type</div>\r\n                    <div className=\"col\">\r\n                        {auth.isLibrarian() ? \"librarian\" : \"user\"}</div>\r\n                </div>\r\n\r\n                <div className=\"d-grid gap-2 d-md-flex mt-2\">\r\n                    {!auth.isLibrarian() ?\r\n                        <>\r\n                            <div className=\"col-md-6\">\r\n                                <button className=\"primary\"\r\n                                        onClick={handleDeleteAccount}>Delete my account</button>\r\n                            </div>\r\n                        </>\r\n                        :\r\n                        null}\r\n\r\n                    <div className=\"col-md-6\">\r\n                        <button className=\"primary\"\r\n                                onClick={handleLogout}>Log Out</button>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </>\r\n\r\n\r\n    )\r\n}\r\n\r\nexport default AccountPage"],"mappings":"qIAAA,MAAOA,MAAK,EAAGC,SAAS,CAAEC,QAAQ,KAAO,OAAO,CAChD,MAAOC,KAAI,KAAM,cAAc,CAC/B,OAAQC,WAAW,KAAO,kBAAkB,CAC5C,MAAOC,OAAM,KAAM,sBAAsB,CAAC,6IAG1C,GAAMC,YAAW,CAAG,QAAdA,YAAW,EAAS,CACtB,cAA0BJ,QAAQ,CAAC,EAAE,CAAC,wCAA/BK,KAAK,eAAEC,QAAQ,eACtB,GAAMC,SAAQ,CAAGL,WAAW,EAAE,CAE9BH,SAAS,CAAE,UAAM,CACb,GAAG,CAACE,IAAI,CAACO,eAAe,EAAE,CAAC,CACvBD,QAAQ,CAAC,QAAQ,CAAC,CACtB,CACJ,CAAC,CAAC,CAEF,GAAME,aAAY,CAAG,QAAfA,aAAY,EAAS,CACvBR,IAAI,CAACS,UAAU,EAAE,CACjBH,QAAQ,CAAC,GAAG,CAAC,CACjB,CAAC,CAED,GAAMI,oBAAmB,CAAG,QAAtBA,oBAAmB,EAAS,CAC9BC,KAAK,CAAC,wBAAwB,CAACX,IAAI,CAACY,OAAO,EAAE,CACzC,CAACC,MAAM,CAAE,QAAQ,CAAEC,OAAO,CAAE,CAAC,cAAc,CAAE,kBAAkB,CAAC,CAAC,CAAC,CACjEC,IAAI,CAAC,SAAAC,QAAQ,CAAI,CACd,GAAGA,QAAQ,CAACC,EAAE,CAAC,CACXT,YAAY,EAAE,CAClB,CAAC,IAAM,IAAIQ,QAAQ,CAACE,MAAM,EAAI,GAAG,CAAC,CAC9Bb,QAAQ,CAAC,iDAAiD,CAAC,CAC/D,CAAC,IAAM,CACHA,QAAQ,CAAC,8BAA8B,CAAC,CAC5C,CACJ,CAAC,CAAC,CACV,CAAC,CAED,mBACI,wCACI,KAAC,MAAM,IAAG,cACV,oBAAI,YAAU,EAAK,CAElBD,KAAK,EAAI,EAAE,cACR,YAAK,SAAS,CAAC,iDAAiD,CAAC,IAAI,CAAC,OAAO,UACxEA,KAAK,EACJ,CAAG,IAAI,cAGjB,aAAK,SAAS,CAAC,eAAe,wBAE1B,aAAK,SAAS,CAAC,KAAK,wBAChB,YAAK,SAAS,CAAC,KAAK,UAAC,UAAQ,EAAM,cACnC,YAAK,SAAS,CAAC,KAAK,UAAEJ,IAAI,CAACY,OAAO,EAAE,EAAO,cAC3C,YAAK,SAAS,CAAC,OAAO,EAAO,cAC7B,YAAK,SAAS,CAAC,KAAK,UAAC,WAAS,EAAM,cACpC,YAAK,SAAS,CAAC,KAAK,UACfZ,IAAI,CAACmB,WAAW,EAAE,CAAG,WAAW,CAAG,MAAM,EAAO,GACnD,cAEN,aAAK,SAAS,CAAC,6BAA6B,WACvC,CAACnB,IAAI,CAACmB,WAAW,EAAE,cAChB,sCACI,YAAK,SAAS,CAAC,UAAU,uBACrB,eAAQ,SAAS,CAAC,SAAS,CACnB,OAAO,CAAET,mBAAoB,UAAC,mBAAiB,EAAS,EAC9D,EACP,CAEH,IAAI,cAER,YAAK,SAAS,CAAC,UAAU,uBACrB,eAAQ,SAAS,CAAC,SAAS,CACnB,OAAO,CAAEF,YAAa,UAAC,SAAO,EAAS,EAC7C,GAEJ,GACJ,GACP,CAIX,CAAC,CAED,cAAeL,YAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}